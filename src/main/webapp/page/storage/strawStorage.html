<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>选择液氮罐--液氮罐冷冻系统</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../../layui/newVersion/layui.css" media="all" />
    <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css"/>
</head>
<body>
<blockquote class="layui-elem-quote" style="margin: 20px">所有液氮罐</blockquote>
    <div class="layui-row nit_content" style="margin: 20px">
        <!--<div class="layui-col-xs12 layui-col-sm12 layui-col-md12" style="margin: 10px;border: 1px solid seagreen;padding: 10px">
            <div style="margin: 10px"><i class="fa fa-hourglass-end" aria-hidden="true"></i> A号液氮罐</div>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>1</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"> <span>2</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>3</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>4</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"> <span>5</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"> <span>6</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>7</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>8</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>9</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>10</span>号吊桶</a>
        </div>
        <div class="layui-col-xs12 layui-col-sm12 layui-col-md12" style="margin: 10px;border: 1px solid seagreen;padding: 10px">
            <div style="margin: 10px"><i class="fa fa-hourglass-end" aria-hidden="true"></i> B号液氮罐</div>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>1</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"> <span>2</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>3</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>4</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"> <span>5</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"> <span>6</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>7</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>8</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>9</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>10</span>号吊桶</a>
        </div>-->
    </div>

<script type="text/javascript" src="../../layui/layui.js"></script>
<script>
    //JavaScript代码区域
    layui.use(['layer','jquery'], function(){
        var layer = layui.layer;
        $ = layui.jquery;

        var nitData = '';
        $.get("/nits", function(data){
            nitData = data;
            console.log(data)
            var dataHtml = '';
            for (var i=0; i<data.length; i++){
                dataHtml += '<div class="layui-col-xs12 layui-col-sm12 layui-col-md12 tub_content" style="margin: 10px;border: 1px solid seagreen;padding: 10px">' +
                    '<div style="margin: 10px"><i class="fa fa-hourglass-end" aria-hidden="true"></i> ' +
                    '<span>'+data[i].nitNum+'</span>号液氮罐</div>'
                    + '</div>';

                $.ajax({
                    url : "/tubInfo/"+data[i].nitId,
                    type : "get",
                    dataType : "json",
                    success : function (data) {
                        console.log(data)
                        var dataHtml = '';
                        for (var i=0; i<data.length; i++){
                            dataHtml += '<a class="layui-btn straws_edit" style="margin: 5px"><span>'+data[i].tubNum+'</span>号吊桶</a>'+data[i].nitId;
                        }
                        $(".tub_content").html(dataHtml)
                    }

                })
            }
            $(".nit_content").html(dataHtml);
        });


        //获取液氮罐下所有的信息
        $("body").on("click",".nit_click",function () {
            var _this = $(this);
            for(var i=0; i<nitData.length; i++){
                if (nitData[i].nitId == _this.attr("data-id")){
                    //获取当前点击的病人ID
                    var nitId = nitData[i].nitId;
                    console.log(nitId)
                    var index = layui.layer.open({
                        title : "查看液氮罐下可存放麦管的位置",
                        type : 2,
                        content : "divepipeStorage.html",
                        success : function (layero,index) {
                            //获取子页面
                            var body = layui.layer.getChildFrame('body', index);
                            body.find("#nitId").text(nitId);
                            $.ajax({
                                url : "/nits/"+nitId,
                                type : "get",
                                dataType : "json",
                                success : function (data) {
                                    console.log(data)
                                    body.find("#nitNum").text(data.nitNum);
                                }
                            })
                        }
                    })
                    //改变窗口大小时，重置弹窗的高度，防止超出可视区域（如F12调出debug的操作）
                    $(window).resize(function () {
                        layui.layer.full(index);
                    })
                    layui.layer.full(index);
                }
            }

        })
    });
</script>
</body>
</html>