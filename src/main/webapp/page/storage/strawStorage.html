<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>选择液氮罐--液氮罐冷冻系统</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../../layui/newVersion/layui.css" media="all" />
    <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css"/>
</head>
<body>
<blockquote class="layui-elem-quote" style="margin: 20px">
    <span>所有液氮罐&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span><a class="layui-btn layui-btn-normal reload" style="background-color:#269f42">刷新&nbsp;<i class="fa fa-refresh" aria-hidden="true"></i></a></span>
</blockquote>
    <div class="layui-row nit_content" style="margin: 20px">
        <div id="tub_content"></div>
        <!--<div class="layui-col-xs12 layui-col-sm12 layui-col-md12" style="margin: 10px;border: 1px solid seagreen;padding: 10px">
            <div style="margin: 10px"><i class="fa fa-hourglass-end" aria-hidden="true"></i> A号液氮罐</div>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>1</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"> <span>2</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>3</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>4</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"> <span>5</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"> <span>6</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>7</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>8</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>9</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="padding: 2px;margin: 5px"><span>10</span>号吊桶</a>
        </div>
        <div class="layui-col-xs12 layui-col-sm12 layui-col-md12" style="margin: 10px;border: 1px solid seagreen;padding: 10px">
            <div style="margin: 10px"><i class="fa fa-hourglass-end" aria-hidden="true"></i> B号液氮罐</div>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>1</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"> <span>2</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>3</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>4</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"> <span>5</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"> <span>6</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>7</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>8</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>9</span>号吊桶</a>
            <a class="layui-btn straws_edit" style="margin: 5px"><span>10</span>号吊桶</a>
        </div>-->
    </div>

<script type="text/javascript" src="../../layui/layui.js"></script>
<script>
    //JavaScript代码区域
    layui.use(['layer','jquery'], function(){
        var layer = layui.layer;
        $ = layui.jquery;

        $(".reload").click(function () {
            window.location.reload();
        });

        var dataInfo = '';
        $.get("/tubInfo", function(data){
            dataInfo = data;
            console.log(dataInfo)
            var dataHtml = '';
            for (var i=0; i<data.length; i++){
                dataHtml += '<div class="layui-col-xs12 layui-col-sm12 layui-col-md12" style="margin: 10px;border: 1px solid seagreen;padding: 10px">' +
                    '<div style="margin: 10px"><i class="fa fa-hourglass-end" aria-hidden="true"></i> ' +
                    '<span>'+data[i].nit.nitNum+'</span>号液氮罐</div>';

                for (var j=0; j<data[i].tubList.length;j++){
                    dataHtml += '<a class="layui-btn tub_click" style="margin: 5px" data-id="'+data[i].tubList[j].tubId+'">' +
                        '<span>'+data[i].tubList[j].tubNum+'</span>号吊桶</a>';
                }
                dataHtml += '</div>';
            }

            $(".nit_content").html(dataHtml);
        });


        //获取液氮罐下所有的信息
        $("body").on("click",".tub_click",function () {
            var _this = $(this);
            for(var i=0; i<dataInfo.length; i++){
                for (var j=0; j<dataInfo[i].tubList.length;j++){
                    if (dataInfo[i].tubList[j].tubId == _this.attr("data-id")){
                        //获取当前点击的病人ID
                        var tubId = dataInfo[i].tubList[j].tubId;
                        console.log(tubId)
                        var index = layui.layer.open({
                            title : "查看"+dataInfo[i].nit.nitNum+"号液氮罐"+dataInfo[i].tubList[j].tubNum+"号吊桶下的套管信息",
                            type : 2,
                            content : "divepipeStorage.html",
                            success : function (layero,index) {
                                //获取子页面
                                var body = layui.layer.getChildFrame('body', index);
                                body.find("#tubId").text(tubId);
                                $.ajax({
                                    url : "/divepipeByTubId/"+tubId,
                                    type : "get",
                                    dataType : "json",
                                    success : function (data) {
                                        console.log(data)
                                    }
                                })
                            }
                        })
                        //改变窗口大小时，重置弹窗的高度，防止超出可视区域（如F12调出debug的操作）
                        $(window).resize(function () {
                            layui.layer.full(index);
                        })
                        layui.layer.full(index);
                    }
                }
            }

        })
    });
</script>
</body>
</html>